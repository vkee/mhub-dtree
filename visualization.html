
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="../../favicon.ico">

    <title>Mission Hub Discipleship Chains</title>

    <!-- Bootstrap core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="css/styles.css" rel="stylesheet">

    <!-- JS Files -->
    <script type="text/javascript" src="js/jquery-2.1.3.min.js"></script>
    <script type="text/javascript" src="js/bootstrap.min.js"></script>
    <script type="text/javascript" src="js/d3.min.js"></script>
    <script type="text/javascript" src="js/dagre-d3.min.js"></script>
    <script type="text/javascript" src="src/graph.js"></script>
    <script type="text/javascript" src="src/secret.js"></script>
    <script type="text/javascript" src="src/interaction_tree.js"></script>

    <!-- Custom styles for this template -->

    <!-- Just for debugging purposes. Don't actually copy these 2 lines! -->
    <!--[if lt IE 9]><script src="../../assets/js/ie8-responsive-file-warning.js"></script><![endif]-->

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Google Chart -->
    <script type="text/javascript" src="https://www.google.com/jsapi"></script>
    <script type="text/javascript">
    google.load("visualization", "1", {packages:["corechart"]});
    google.setOnLoadCallback(drawSeriesChart);

    function drawSeriesChart() {
      // var data = google.visualization.arrayToDataTable([
      //   ['ID', 'Days Since Last Interaction', '# of Interactions', 'Group',     'Size'],
      //   ['Todd',    80,              5,      'Leader',  5],
      //   ['Ethan',    23,              2,      'Leader',  5],
      //   ['Ja-Hon',    1,              10,      'Community',    5],
      //   ['Kate',    69,              1,       'Community',    5],
      //   ['Annalee',    1,              4,      'Community',    5],
      //   ['Dieter',    49,              2,         'Interactions',         5],
      //   ['Jimmy',    63,              6,      'Interactions',    5],
      //   ['Igor',    1,               3,      'Interactions',         5],
      //   ['Mustafa',    43,              3,      'Interactions',         5],
      //   ['Andy',    22,               2,      'Interactions',         5]
      // ]);
      // console.log(data);
      // var options = {
      //   series: {
      //       Leader: { color: '#e2431e' },
      //       Community: { color: '#e7711b' },
      //       Interactions: { color: '#f1ca3a' },
      //   },
      //   title: 'Asaph Yuan',
      //   // explorer: { axis: 'horizontal', keepInBounds: true },
      //   hAxis: {title: 'Days Since Last Interaction', viewWindowMode:'explicit',
      //         viewWindow:{
      //           max:100,
      //           min:-8
      //         }},
      //   vAxis: {title: 'Number of Interactions', viewWindowMode:'explicit',
      //         viewWindow:{
      //           max:12,
      //           min:0
      //         }},
      //   bubble: {textStyle: {fontSize: 11},
      //     color: 'green',
      //     textStyle: {
      //       auraColor: 'none'
      // }}

      // };

      // var chart = new google.visualization.BubbleChart(document.getElementById('series_chart_div') );
      // chart.draw(data, options);

      function selectHandler() {
          var selectedItem = chart.getSelection()[0];
          if (selectedItem) {
            var person = data.getValue(selectedItem.row, 0);
            alert('The user selected ' + person);
            dataview = new google.visualization.DataView(data);
            dataview.hideRows([0,1,2])
            // you can also use dataview.setColumns([1,2]) to show only selected columns and hide the rest
            chart.draw(dataview, options)
          }
        }

        google.visualization.events.addListener(chart, 'select', selectHandler);

        // var handler = function(e) {
        //     alert('here');
        //   // if row is undefined, we clicked on the legend
        //   if (typeof chart.getSelection()[0]['row'] === 'undefined') {
        //     alert('here');
        //   }
        //     var parts = e.targetID.split('#');
        //     if (parts.indexOf('legend') >= 0) {
        //         alert("here");
        //         var idx = parts[parts.indexOf('legend') + 1];
        //         alert(data.getValue(0, parseInt(idx)));
        //     }
        // };
        // google.visualization.events.addListener(chart, 'click', handler);
    }
    var dataCallback = function(data2){
      // console.log('data');
      // console.log(data2);
      dataToDisplay = [];
      dataToDisplay.push(['ID', 'Days Since Last Interaction', '# of Interactions', 'Group',     'Size']);
        for (i = 0; i < data2.length; i++) {
            dataToDisplay.push([data2[i], i+1, i+1, "Interactions", 5]);
        }
        // console.log(dataToDisplay);
        var dataTable = google.visualization.arrayToDataTable(dataToDisplay);
        // console.log(dataTable);
        
      //   dataview = new google.visualization.DataView(data);
      // var data = google.visualization.arrayToDataTable([
      //   ['ID', 'Days Since Last Interaction', '# of Interactions', 'Group',     'Size'],
      //   ['Todd',    80,              5,      'Leader',  5],
      //   ['Ethan',    23,              2,      'Leader',  5],
      //   ['Ja-Hon',    1,              10,      'Community',    5],
      //   ['Kate',    69,              1,       'Community',    5],
      //   ['Annalee',    1,              4,      'Community',    5],
      //   ['Dieter',    49,              2,         'Interactions',         5],
      //   ['Jimmy',    63,              6,      'Interactions',    5],
      //   ['Igor',    1,               3,      'Interactions',         5],
      //   ['Mustafa',    43,              3,      'Interactions',         5],
      //   ['Bob',    22,               2,      'Interactions',         5]
      // ]);

      var options = {
        series: {
            Leader: { color: '#e2431e' },
            Community: { color: '#e7711b' },
            Interactions: { color: '#f1ca3a' },
        },
        title: 'Asaph Yuan',
        // explorer: { axis: 'horizontal', keepInBounds: true },
        hAxis: {title: 'Days Since Last Interaction', viewWindowMode:'explicit',
              viewWindow:{
                max:100,
                min:-8
              }},
        vAxis: {title: 'Number of Interactions', viewWindowMode:'explicit',
              viewWindow:{
                max:12,
                min:0
              }},
        bubble: {textStyle: {fontSize: 11},
          color: 'green',
          textStyle: {
            auraColor: 'none'
      }}

      };

      var chart = new google.visualization.BubbleChart(document.getElementById('series_chart_div') );
        chart.draw(dataTable, options);
    }

    $(document).ready(function(){
      $('#display_button').click(function(){
        var dataToDisplay = []
        var formElements = document.forms['form'].elements['name'].value;
        getPersonInteractions(formElements, "941", dataCallback);
        
      });
    });


    </script>
  </head>

  <body>
    <div class="container">

      <div class="page-header text-center">
        <h1>MissionHub Discipleship Chains</h1>
        <p class="lead">View your leaders, interactions, and labeled groups!</p>
      </div>
      <div class="row">
        <div class="col-md-3">
           <div>
            <div class="input-group">
              <form id="form">
              <input type="text" class="form-control" placeholder="Name" id="name">
              <span class="input-group-btn">
              <button class="btn btn-default" type="button" id="display_button">Display!</button>
              </span>
              </form>
            </div><!-- /input-group -->
          </div>
        </div>
        <div class="col-md-9 text-center">
          <div class="btn-group" role="group" aria-label="...">
            <button type="button" class="btn btn-default">Group Leader</button>
            <button type="button" class="btn btn-default">Interaction</button>

            <div class="btn-group" role="group">
              <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-expanded="false">
                Add Label
                <span class="caret"></span>
              </button>
              <ul class="dropdown-menu" role="menu">
                <li><a href="#">Populated by JS</a></li>
                <li><a href="#">BU Warren Life Group</a></li>
              </ul>
            </div>
          </div>
        </div>
        <div class = "row">
          <div class="col-md-12 text-right">
          <div id="series_chart_div" style="width: 900px; height: 500px;"></div>
          </div>
        </div>
    </div> <!-- /container -->


    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
  </body>
</html>
